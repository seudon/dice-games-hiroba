---
// src/pages/index.astro
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import GameCard from '../components/ui/GameCard.astro';

const allGames = await getCollection('games');
const featuredGames = allGames.filter(g => g.data.featured);
const recentGames = allGames
  .sort((a, b) => b.data.publishedAt.getTime() - a.data.publishedAt.getTime())
  .slice(0, 3);

const baseUrl = import.meta.env.BASE_URL;
---

<BaseLayout title="ホーム">
  <!-- ヒーローセクション -->
  <div class="text-center mb-5">
    <h1 class="display-4 fw-bold mb-4">ようこそ!サイコロゲーム広場へ</h1>
    <p class="lead text-dark mb-4">
      様々なサイコロゲームのルール、記録表、ブラウザゲームを提供しています。<br>
      実際のサイコロで遊ぶのが一番楽しいですが、サイコロがない時でも<br>
      ブラウザ上で遊ぶことができます。
    </p>
    <div class="d-flex gap-3 justify-content-center flex-wrap">
      <a href={`${baseUrl}games`} class="btn btn-primary btn-lg">
        ゲーム一覧を見る
      </a>
      <a href={`${baseUrl}about`} class="btn btn-secondary btn-lg">
        このサイトについて
      </a>
    </div>
  </div>

  <!-- おすすめゲーム -->
  {featuredGames.length > 0 && (
    <div class="mb-5">
      <h2 class="text-center fw-bold mb-4">⭐ おすすめのゲーム</h2>
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        {featuredGames.map(game => (
          <div class="col">
            <GameCard game={game} />
          </div>
        ))}
      </div>
    </div>
  )}

  <!-- 最近追加されたゲーム -->
  {recentGames.length > 0 && (
    <div class="mb-5">
      <h2 class="text-center fw-bold mb-4">🆕 最近追加されたゲーム</h2>
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        {recentGames.map(game => (
          <div class="col">
            <GameCard game={game} />
          </div>
        ))}
      </div>
    </div>
  )}

  <!-- 特徴セクション -->
  <div class="bg-white rounded shadow p-4 mb-5">
    <h2 class="text-center fw-bold mb-4">このサイトの特徴</h2>
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
      <div class="col">
        <div class="card h-100">
          <div class="card-body text-center">
            <div class="display-1 mb-3">📖</div>
            <h3 class="h5 fw-bold">わかりやすいルール説明</h3>
            <p class="text-dark">初心者にもわかりやすく、丁寧に解説しています</p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100">
          <div class="card-body text-center">
            <div class="display-1 mb-3">📊</div>
            <h3 class="h5 fw-bold">記録表機能</h3>
            <p class="text-dark">あなたの記録を保存して、友達と競い合えます</p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100">
          <div class="card-body text-center">
            <div class="display-1 mb-3">🎮</div>
            <h3 class="h5 fw-bold">ブラウザゲーム</h3>
            <p class="text-dark">サイコロがなくても、ブラウザ上で遊べます</p>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card h-100">
          <div class="card-body text-center">
            <div class="display-1 mb-3">👨‍👩‍👧‍👦</div>
            <h3 class="h5 fw-bold">全世代対応</h3>
            <p class="text-dark">子供から高齢者まで楽しめる内容です</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</BaseLayout>
